# Main function to execute the Simplex algorithm
maxDualSimplex <- function(values){
  tableau <- matrix(c(65,65,81,73.8,277.4,88.2,171.5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2250,-65,-65,-81,-73.8,-277.4,-88.2,-171.5,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-2000,0,0,0,0,129.9,0,0,0,0,
           1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,300,1,1,3.3,0.8,10.8,5.5,0.2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,65,134.5,132.5,68.9,68.2,125.6,8.1,15.2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2400,12.4,11.8,12.4,13.6,0,2.2,39.9,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,300,1.3,1.1,0.6,8.5,0,1.4,3.2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,-1.3,-1.1,-0.6,-8.5,0,-1.4,-3.2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-25,2.2,2.3,1.1,8,42.2,9.4,3.7,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,-2.2,-2.3,-1.1,-8,-42.2,-9.4,-3.7,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-50,0,0,2.9,5867.4,77.4,98.6,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50000,0,0,-2.9,-5867.4,-77.4,-98.6,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-5000,0,0,0.1,160.2,0,0.1,15.6,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,20000,0,0,-0.1,-160.2,0,-0.1,-15.6,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,-50,10.8,26.2,6.7,159,21.9,121.8,22.7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1600,-10.8,-26.2,-6.7,-159,-21.9,-121.8,-22.7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,-800,0.7,0.8,0.5,2.3,1.8,6.2,4.3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,30,-0.7,-0.8,-0.5,-2.3,-1.8,-6.2,-4.3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,-10,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,10,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,10,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,10,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,10,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,10,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,10,0,0
           ,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,10,-0.05,-0.06,-0.09,-0.16,-0.84,-0.31,-0.06,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0), nrow=26, ncol=34, byrow=TRUE)
  
  pivotCol <- function(Z, PR){
    if(Z[1] != 0){
      min <-  Z[1] / PR[1]
      col <- 1
    }
    
    for(i in 2:(length(PR)-1)){
      if(Z[i] != 0)
        ratio <- Z[i] / PR[i]
      else
        next
      
      if(ratio < min && ratio >= 0 || ratio >= 0 && min < 0 ){
        min <- ratio
        col <- i
      }
    }
    col  # Return the pivot column index
  }
  
  # Function to compute the basic solution from the tableau
  compute_solution <- function(tableau){
    nonzero_counter <- 0  # Counter for non-zero elements
    basic_solution <- c(1:(ncol(tableau)-1))  # Initialize basic solution
    for(i in 1:(ncol(tableau)-1)){  # Loop through the columns
      for(j in 1:nrow(tableau)){  # Loop through the rows
        if(tableau[j,i] != 0){  # If the element is non-zero
          nonzero_counter = nonzero_counter + 1  # Increment counter
          nonzero_value <- tableau[j,i]  # Store the non-zero value
          nonzero_index <- j  # Store the row index
        }
        
        if(nonzero_counter > 1){  # If more than one non-zero found, break
          basic_solution[i] = 0  # Set to 0
          break
        }
      }
      if(nonzero_counter == 1){  # If exactly one non-zero found
        basic_solution[i] = tableau[nonzero_index, ncol(tableau)] / tableau[nonzero_index, i]  # Compute basic solution
      }
      nonzero_counter <- 0  # Reset counter for the next column
      
    }
    
    basic_solution  # Return the basic solution vector
  }
  
  counter <- 1;
  while(-1 %in% sign(tableau[, ncol(tableau)]) && -1 %in% sign(tableau[nrow(tableau), 1:ncol(tableau)-1])){  # While there are negative elements in the last row
    PR <- which(tableau[, ncol(tableau)] == -1* max(-1*tableau[, ncol(tableau)]))
    PC <- pivotCol(tableau[nrow(tableau), ], tableau[PR, ])  # Find the pivot column
    tableau[PR, ] <- tableau[PR, ] / tableau[PR,PC]  # Normalize the pivot row

    for(i in 1:nrow(tableau)){  # Update the tableau
      if(i == PR)  # Skip the pivot row
        next
      tableau[i, ] = tableau[i, ] - (tableau[PR, ] * tableau[i, PC])  # Apply the pivot row operation
    }
  }
  
  basic_solution <- compute_solution(tableau)  # Compute basic solution if maximizing

  # Return a list containing the final tableau, basic solution, and objective value
  list(finalTableau = tableau, basicSolution = basic_solution, Z = tableau[nrow(tableau), ncol(tableau)])
}
# Example tableau for a maximization problem  
tableau <- matrix(c(65,65,81,73.8,277.4,88.2,171.5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2250,-65,-65,-81,-73.8,-277.4,-88.2,-171.5,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-2000,0,0,0,0,129.9,0,0,0,0,
                    1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,300,1,1,3.3,0.8,10.8,5.5,0.2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,65,134.5,132.5,68.9,68.2,125.6,8.1,15.2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2400,12.4,11.8,12.4,13.6,0,2.2,39.9,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,300,1.3,1.1,0.6,8.5,0,1.4,3.2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,-1.3,-1.1,-0.6,-8.5,0,-1.4,-3.2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-25,2.2,2.3,1.1,8,42.2,9.4,3.7,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,-2.2,-2.3,-1.1,-8,-42.2,-9.4,-3.7,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-50,0,0,2.9,5867.4,77.4,98.6,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50000,0,0,-2.9,-5867.4,-77.4,-98.6,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-5000,0,0,0.1,160.2,0,0.1,15.6,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,20000,0,0,-0.1,-160.2,0,-0.1,-15.6,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,-50,10.8,26.2,6.7,159,21.9,121.8,22.7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1600,-10.8,-26.2,-6.7,-159,-21.9,-121.8,-22.7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,-800,0.7,0.8,0.5,2.3,1.8,6.2,4.3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,30,-0.7,-0.8,-0.5,-2.3,-1.8,-6.2,-4.3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,-10,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,10,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,10,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,10,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,10,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,10,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,10,0,0
                    ,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,10,-0.05,-0.06,-0.09,-0.16,-0.84,-0.31,-0.06,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0), nrow=26, ncol=34, byrow=TRUE)

